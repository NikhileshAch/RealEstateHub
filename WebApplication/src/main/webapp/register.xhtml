<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
<h:head>
    <title>Register - RealEstateHub</title>
    <h:outputStylesheet name="css/style.css"/>
</h:head>
<h:body>
    <div class="container register-container">
        <h1>Register for RealEstateHub</h1>
        
        <h:messages globalOnly="true" styleClass="messages"/>
        
        <h:form styleClass="register-form">
            <div class="form-group">
                <h:outputLabel for="role" value="Register as:*"/>
                <h:selectOneMenu id="role" value="#{registerBean.selectedRole}" required="true" 
                                 styleClass="form-control" requiredMessage="Please select a role">
                    <f:selectItem itemValue="" itemLabel="-- Select Role --"/>
                    <f:selectItem itemValue="BUYER" itemLabel="Buyer"/>
                    <f:selectItem itemValue="SELLER" itemLabel="Seller"/>
                    <f:ajax render="budgetGroup"/>
                </h:selectOneMenu>
                <h:message for="role" styleClass="error-message"/>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <h:outputLabel for="firstName" value="First Name:*"/>
                    <h:inputText id="firstName" value="#{registerBean.firstName}" required="true" 
                                 styleClass="form-control" requiredMessage="First name is required">
                        <f:validateLength minimum="2" maximum="50"/>
                    </h:inputText>
                    <h:message for="firstName" styleClass="error-message"/>
                </div>
                
                <div class="form-group">
                    <h:outputLabel for="lastName" value="Last Name:*"/>
                    <h:inputText id="lastName" value="#{registerBean.lastName}" required="true" 
                                 styleClass="form-control" requiredMessage="Last name is required">
                        <f:validateLength minimum="2" maximum="50"/>
                    </h:inputText>
                    <h:message for="lastName" styleClass="error-message"/>
                </div>
            </div>
            
            <div class="form-group">
                <h:outputLabel for="email" value="Email:*"/>
                <h:inputText id="email" value="#{registerBean.email}" required="true" 
                             styleClass="form-control" requiredMessage="Email is required">
                    <f:validateRegex pattern="[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}"/>
                </h:inputText>
                <h:message for="email" styleClass="error-message"/>
            </div>
            
            <div class="form-group">
                <h:outputLabel for="username" value="Username:*"/>
                <h:inputText id="username" value="#{registerBean.username}" required="true" 
                             styleClass="form-control" requiredMessage="Username is required">
                    <f:validateLength minimum="3" maximum="30"/>
                </h:inputText>
                <h:message for="username" styleClass="error-message"/>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <h:outputLabel for="password" value="Password:*"/>
                    <h:inputSecret id="password" value="#{registerBean.password}" required="true" 
                                   styleClass="form-control" requiredMessage="Password is required">
                        <f:validateLength minimum="6"/>
                    </h:inputSecret>
                    <h:message for="password" styleClass="error-message"/>
                </div>
                
                <div class="form-group">
                    <h:outputLabel for="confirmPassword" value="Confirm Password:*"/>
                    <h:inputSecret id="confirmPassword" value="#{registerBean.confirmPassword}" 
                                   required="true" styleClass="form-control" 
                                   requiredMessage="Please confirm password"/>
                    <h:message for="confirmPassword" styleClass="error-message"/>
                </div>
            </div>
            
            <h:panelGroup id="budgetGroup">
                <div class="form-group" rendered="#{registerBean.selectedRole == 'BUYER'}">
                    <h:outputLabel for="budget" value="Budget (CHF):*"/>
                    <h:inputText id="budget" value="#{registerBean.budget}" required="#{registerBean.selectedRole == 'BUYER'}" 
                                 styleClass="form-control" requiredMessage="Budget is required for buyers">
                        <f:validateDoubleRange minimum="0.01"/>
                        <f:convertNumber type="currency" currencySymbol="CHF" maxFractionDigits="2"/>
                    </h:inputText>
                    <h:message for="budget" styleClass="error-message"/>
                </div>
            </h:panelGroup>
            
            <div class="form-actions">
                <h:commandButton value="Register" action="#{registerBean.register}" styleClass="btn btn-primary"/>
                <h:button value="Cancel" outcome="index" styleClass="btn btn-secondary"/>
            </div>
        </h:form>
        
        <div class="login-link">
            <p>Already have an account? <h:link outcome="login" value="Login here"/></p>
        </div>
    </div>
</h:body>
</html>
